<p class="page-heading margin-login" fxLayoutAlign="center center"> Contact Cards</p>

<div fxLayoutAlign="center right">
  <form>
    <mat-form-field>
      <input matInput placeholder="Search by name" id="searchbox" name="searchStr" type="text" [(ngModel)]="searchStr"
        (keyup)="searchContact()">
    </mat-form-field>
  </form>
</div>

<div>
  <div *ngFor="let res of searchRes" fxLayout="column" fxLayoutAlign="start center" class="margin-login">
    <mat-card>
      <mat-card-title>{{ res.displayName }}</mat-card-title>
      <div class="float-avatar-right"><img [src]="avatar" alt="User Avatar"></div>
      <mat-card-content>{{ res.mail }}</mat-card-content>
    </mat-card>
  </div>
</div>

<ng-container *ngIf="(infinate$ | async) as infinate; else spinner">
  <cdk-virtual-scroll-viewport itemSize="24" class="flex-grow-1"
    (scrolledIndexChange)="loadNextUsers($event, infinate.nextLink)">
    <div fxLayout="column" fxLayoutAlign="start center" class="margin-login">
      <mat-card *cdkVirtualFor="let user of infinate.data">
        <mat-card-title>{{ user.displayName }}</mat-card-title>
        <div class="float-avatar-right"><img [src]="avatar" alt="User Avatar"></div>
        <mat-card-content>
          <a href="mailto:{{ user.mail }}" target="_top">{{ user.mail }} </a>
        </mat-card-content>
      </mat-card>
    </div>
    <ng-container *ngTemplateOutlet="spinner"></ng-container>
  </cdk-virtual-scroll-viewport>
</ng-container>

<ng-template #spinner>
  <div fxLayout="column" fxLayoutAlign="start center" *ngIf="loadingSpinner$ | async" class="margin-login"
    role="status">
    <app-contactspinner></app-contactspinner>
  </div>
</ng-template>